{
    # Global options
    admin off
}

:80 {
    # Root directory for static files
    root * /usr/share/caddy

    # Enable compression
    encode gzip

    # Cache static assets
    @static {
        path *.jpg *.jpeg *.png *.gif *.ico *.css *.js
    }
    header @static Cache-Control "public, max-age=86400"

    # Handle React router - serve index.html for non-file requests
    try_files {path} /index.html

    # API proxy - use environment variable
    handle_path /api/* {
        reverse_proxy {$BACKEND_URL} {
            header_up Host {host}
            header_up X-Real-IP {remote_host}
            header_up X-Forwarded-For {remote_host}
            header_up X-Forwarded-Proto {scheme}
            
            # Add timeout settings
            timeout 30s
        }
    }

    # Serve static files
    file_server
} 